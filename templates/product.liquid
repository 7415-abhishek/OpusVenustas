<main>
  <section class="hero">
    <div class="container">
      <div class="section-heading" style="margin-bottom: 2rem;">
        <div class="section-title">Product Detail</div>
        <p class="section-subtitle">
          View details, sizing, and pricing for this OpusVenustas piece. All amounts shown are in INR.
        </p>
      </div>

      {% if product %}
        <div class="story-grid">
          <div>
            <div class="product-image" style="margin-bottom: 1.2rem;">
              {% if product.featured_image %}
                {{ product.featured_image | image_url: width: 900 | image_tag: alt: product.title }}
              {% endif %}
            </div>

            {% if product.images.size > 1 %}
              <div style="display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 0.5rem; margin-bottom: 1.5rem;">
                {% for image in product.images %}
                  <div class="product-image" style="aspect-ratio: 1 / 1; margin-bottom: 0;">
                    {{ image | image_url: width: 400 | image_tag: alt: product.title }}
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          </div>

          <div>
            <h1 style="font-size: 1.35rem; margin-bottom: 0.5rem;">{{ product.title }}</h1>
            <div style="font-size: 1.1rem; margin-bottom: 0.4rem;">
              <strong>{{ product.price | money }}</strong>
              {% if product.compare_at_price_max > product.price %}
                <span style="font-size: 0.85rem; text-decoration: line-through; opacity: 0.7; margin-left: 0.4rem;">
                  {{ product.compare_at_price_max | money }}
                </span>
              {% endif %}
            </div>

            {% if product.available %}
              <div style="font-size: 0.8rem; margin-bottom: 0.9rem; color: var(--muted);">
                In stock · Ships across India · All prices inclusive of taxes
              </div>
            {% else %}
              <div style="font-size: 0.8rem; margin-bottom: 0.9rem; color: var(--muted);">
                Currently sold out
              </div>
            {% endif %}

            <div style="font-size: 0.85rem; color: var(--muted); margin-bottom: 1.2rem;">
              {{ product.description }}
            </div>

            {% form 'product', product %}
              {% if product.variants.size > 1 %}
                <div class="form-row" style="margin-bottom: 0.8rem;">
                  <div>
                    <label for="ProductSelect">Select variant</label>
                    <select id="ProductSelect" name="id" style="width: 100%; border-radius: 999px; border: 1px solid var(--border-soft); background: rgba(4,6,10,0.96); padding: 0.65rem 0.8rem; color: var(--text); font-size: 0.8rem;">
                      {% for variant in product.variants %}
                        {% if variant.available %}
                          <option value="{{ variant.id }}">
                            {{ variant.title }} — {{ variant.price | money }}
                          </option>
                        {% else %}
                          <option value="{{ variant.id }}" disabled>
                            {{ variant.title }} — Sold out
                          </option>
                        {% endif %}
                      {% endfor %}
                    </select>
                  </div>
                </div>
              {% else %}
                <input type="hidden" name="id" value="{{ product.variants.first.id }}">
              {% endif %}

              <div class="form-row" style="margin-bottom: 0.8rem;">
                <div>
                  <label for="Quantity">Qty</label>
                  <input
                    id="Quantity"
                    type="number"
                    name="quantity"
                    value="1"
                    min="1"
                    style="width: 100%; max-width: 120px;"
                  >
                </div>
              </div>

              <button type="submit" class="btn-submit" {% unless product.available %}disabled style="opacity: 0.6; cursor: not-allowed;"{% endunless %}>
                {% if product.available %}Add to bag — {{ product.price | money }}{% else %}Sold out{% endif %}
              </button>
            {% endform %}

            <div style="font-size: 0.75rem; color: var(--muted); margin-top: 1.1rem;">
              Secure payments via Shopify. All prices in INR. You will see the final total at checkout.
            </div>
          </div>
        </div>
      {% else %}
        <p style="color: var(--muted); font-size: 0.9rem;">Product not found.</p>
      {% endif %}
    </div>
  </section>
</main>
