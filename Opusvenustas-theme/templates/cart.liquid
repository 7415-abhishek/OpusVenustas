<main>
  <section class="hero">
    <div class="container">
      <div class="section-heading" style="margin-bottom: 1.5rem;">
        <div class="section-title">Your Bag</div>
        <p class="section-subtitle">
          Review your OpusVenustas pieces before checkout. All prices are in INR and inclusive of taxes.
        </p>
      </div>

      {% if cart.item_count > 0 %}
        <form action="/cart" method="post" novalidate>
          <div style="display: grid; gap: 1rem; margin-bottom: 1.5rem;">
            {% for item in cart.items %}
              <div class="story-grid" style="align-items: center; border-radius: var(--radius-lg); background: var(--bg-soft); border: 1px solid var(--border-soft); padding: 0.9rem 1rem;">
                <div>
                  <div class="product-image" style="margin-bottom: 0;">
                    {% if item.image %}
                      {{ item.image | image_url: width: 500 | image_tag: alt: item.product.title }}
                    {% endif %}
                  </div>
                </div>
                <div>
                  <div style="font-size: 0.95rem; margin-bottom: 0.2rem;">{{ item.product.title }}</div>
                  {% if item.variant.title != 'Default Title' %}
                    <div style="font-size: 0.78rem; color: var(--muted); margin-bottom: 0.3rem;">
                      {{ item.variant.title }}
                    </div>
                  {% endif %}
                  <div style="font-size: 0.85rem; margin-bottom: 0.4rem;">
                    <strong>{{ item.line_price | money }}</strong>
                    <span style="font-size: 0.75rem; color: var(--muted); margin-left: 0.4rem;">
                      ({{ item.quantity }} Ã— {{ item.final_price | money }})
                    </span>
                  </div>
                  <div class="form-row" style="max-width: 260px; margin-bottom: 0.4rem;">
                    <div>
                      <label for="updates_{{ item.key }}">Qty</label>
                      <input
                        id="updates_{{ item.key }}"
                        type="number"
                        name="updates[]"
                        value="{{ item.quantity }}"
                        min="0"
                      >
                    </div>
                  </div>
                  <button
                    type="submit"
                    name="update"
                    class="btn-ghost"
                    style="margin-top: 0.2rem; padding-inline: 1.1rem; font-size: 0.75rem;"
                  >
                    Update quantities
                  </button>
                </div>
              </div>
            {% endfor %}
          </div>

          <div style="text-align: right; font-size: 0.9rem; margin-bottom: 1rem;">
            <div>Subtotal: <strong>{{ cart.total_price | money }}</strong></div>
            {% if cart.total_discounts > 0 %}
              <div style="font-size: 0.8rem; color: var(--muted);">
                You saved {{ cart.total_discounts | money }} on this order.
              </div>
            {% endif %}
          </div>

          <div style="display: flex; justify-content: flex-end; gap: 0.6rem;">
            <a href="/collections/all" class="btn-ghost">
              <span>Continue shopping</span>
            </a>
            <button type="submit" name="checkout" class="btn-submit">
              Checkout
            </button>
          </div>
        </form>
      {% else %}
        <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 1rem;">
          Your bag is currently empty. Start with dresses, winter wear, or tees from our edits.
        </p>
        <a href="/collections/all" class="btn-primary">
          Browse all products
        </a>
      {% endif %}
    </div>
  </section>
</main>
